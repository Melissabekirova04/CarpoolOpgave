<!DOCTYPE html>
<html lang="da" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Find kørelejlighed</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Find kørelejlighed</h2>

<!-- Filter Form -->
<form action="/book" method="post">
    <label>Fra:</label>
    <select name="from">
        <option value="">Alle</option>
        <option th:selected="${from == 'Allinge'}">Allinge</option>
        <option th:selected="${from == 'Tejn'}">Tejn</option>
        <option th:selected="${from == 'Gudhjem'}">Gudhjem</option>
        <option th:selected="${from == 'Svaneke'}">Svaneke</option>
        <option th:selected="${from == 'Nexø'}">Nexø</option>
        <option th:selected="${from == 'Rønne'}">Rønne</option>
    </select>

    <label>Til:</label>
    <select name="to">
        <option value="">Alle</option>
        <option th:selected="${to == 'Rønne'}">Rønne</option>
        <option th:selected="${to == 'Allinge'}">Allinge</option>
        <option th:selected="${to == 'Tejn'}">Tejn</option>
        <option th:selected="${to == 'Gudhjem'}">Gudhjem</option>
        <option th:selected="${to == 'Svaneke'}">Svaneke</option>
        <option th:selected="${to == 'Nexø'}">Nexø</option>
    </select>

    <label>Dato:</label>
    <input type="date" name="date" th:value="${date}">

    <hr>
    <button type="submit">Find ture</button>
</form>

<!-- Booking Form -->
<form action="/bookTrips" method="post">
    <!-- Seat selection -->
    <label>Antal pladser (max 12):</label>
    <input type="number" name="seats" min="1" max="12" value="1" th:value="${seats != null ? seats : 1}">

    <hr>

    <!-- Trip list -->
    <div th:if="${#lists.isEmpty(trips)}">
        <p>Ingen ture fundet.</p>
    </div>

    <div th:each="trip : ${trips}">
        <label>
            <input type="checkbox"
                   name="tripIds"
                   th:value="${trip.tripId}"
                   th:disabled="${trip.seats == 0}" />
            <strong>
                <span th:text="${trip.startDestination}"></span> →
                <span th:text="${trip.endDestination}"></span>
            </strong>
            |
            <span th:text="${trip.date}"></span> |
            <span th:text="${trip.time}"></span> |
            <span th:text="${trip.seats}"></span> pladser
        </label>

        <span th:if="${trip.seats == 0}" style="color:red;">
            (Fuldt booket)
        </span>
        <br><br>
    </div>

    <button type="submit">Book valgte ture</button>
</form>

<div style="color:red;">
    <p th:text="${error}"></p>
</div>

<div th:if="${success}" style="color:green; text-align:center; margin-top:20px;">

    <h3 th:text="${success}"></h3>

    <div id="successGif" style="margin-top:15px;">
        <div class="tenor-gif-embed"
             data-postid="6253317051822874865"
             data-share-method="host"
             data-aspect-ratio="1.76596"
             data-width="60%">
            <a href="https://tenor.com/view/car-gif-6253317051822874865">
                Car GIF
            </a>
        </div>
    </div>

</div>

<script type="text/javascript" async src="https://tenor.com/embed.js"></script>

<script th:if="${success}">
    setTimeout(function() {
        const gif = document.getElementById("successGif");
        if (gif) {
            gif.style.display = "none";
        }
    }, 5000);
</script>

</body>
</html>